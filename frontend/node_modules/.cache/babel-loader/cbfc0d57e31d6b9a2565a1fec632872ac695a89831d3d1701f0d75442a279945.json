{"ast":null,"code":"import _regeneratorRuntime from\"C:/Users/Matthew Liebenberg/Dropbox/ML20070003344/3- Full Stack Web Development/L3T15/Capstone Final/frontend/node_modules/@babel/runtime/helpers/esm/regeneratorRuntime.js\";import _asyncToGenerator from\"C:/Users/Matthew Liebenberg/Dropbox/ML20070003344/3- Full Stack Web Development/L3T15/Capstone Final/frontend/node_modules/@babel/runtime/helpers/esm/asyncToGenerator.js\";import _defineProperty from\"C:/Users/Matthew Liebenberg/Dropbox/ML20070003344/3- Full Stack Web Development/L3T15/Capstone Final/frontend/node_modules/@babel/runtime/helpers/esm/defineProperty.js\";import _objectSpread from\"C:/Users/Matthew Liebenberg/Dropbox/ML20070003344/3- Full Stack Web Development/L3T15/Capstone Final/frontend/node_modules/@babel/runtime/helpers/esm/objectSpread2.js\";import _slicedToArray from\"C:/Users/Matthew Liebenberg/Dropbox/ML20070003344/3- Full Stack Web Development/L3T15/Capstone Final/frontend/node_modules/@babel/runtime/helpers/esm/slicedToArray.js\";import React,{useState}from'react';import{useNavigate}from'react-router-dom';import jwt_decode from'jwt-decode';import{Link}from'react-router-dom';import{jsx as _jsx}from\"react/jsx-runtime\";import{jsxs as _jsxs}from\"react/jsx-runtime\";var styles={container:{display:'flex',flexDirection:'column',alignItems:'center',justifyContent:'center',height:'100vh'},heading:{fontSize:'24px'},errorMessage:{color:'red',fontSize:'14px',marginTop:'10px'},form:{display:'flex',flexDirection:'column',alignItems:'center',gap:'10px',width:'500px',padding:'20px',backgroundColor:'#f7f7f7',borderRadius:'8px',boxShadow:'0px 0px 10px rgba(0, 0, 0, 0.1)'},input:{width:'100%',padding:'10px',border:'1px solid #ccc',borderRadius:'4px',fontSize:'16px'},button:{width:'100%',padding:'10px',backgroundColor:'#007bff',color:'white',border:'none',borderRadius:'4px',fontSize:'16px',cursor:'pointer'},buttonContainer:{display:'flex',justifyContent:'space-between',width:'50%',gap:'10px'}};function Login(){// State to manage form data and error messages\nvar _useState=useState({username:'',password:'',errorMessage:''}),_useState2=_slicedToArray(_useState,2),formData=_useState2[0],setFormData=_useState2[1];// UseNavigate hook for navigation\nvar navigate=useNavigate();// Event handler for input changes\nvar handleChange=function handleChange(event){var _event$target=event.target,name=_event$target.name,value=_event$target.value;setFormData(function(prevState){return _objectSpread(_objectSpread({},prevState),{},_defineProperty({},name,value));});};// Event handler for form submission\nvar handleSubmit=/*#__PURE__*/function(){var _ref=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime().mark(function _callee(event){var response,data,decodedToken,_data;return _regeneratorRuntime().wrap(function _callee$(_context){while(1)switch(_context.prev=_context.next){case 0:event.preventDefault();_context.prev=1;_context.next=4;return fetch('http://localhost:5000/users/login',{method:'POST',headers:{'Content-Type':'application/json'},body:JSON.stringify(formData)});case 4:response=_context.sent;if(!response.ok){_context.next=12;break;}_context.next=8;return response.json();case 8:data=_context.sent;if(data.token){// Save the token in local storage\nlocalStorage.setItem('token',data.token);// Save the token\n// Decode the token to get user role and save it in local storage\ndecodedToken=jwt_decode(data.token);if(decodedToken&&decodedToken.role){localStorage.setItem('userRole',decodedToken.role);}// Store the username in localStorage during login\nlocalStorage.setItem('username',formData.username);// Navigate to the home page\nnavigate('/');}else{// Display an error message for invalid credentials\nsetErrorMessage('Invalid credentials');}_context.next=16;break;case 12:_context.next=14;return response.json();case 14:_data=_context.sent;// Display an error message received from the server\nsetErrorMessage(_data.message||'Error logging in');case 16:_context.next=22;break;case 18:_context.prev=18;_context.t0=_context[\"catch\"](1);console.error(\"Error during login:\",_context.t0);// Display error message\nsetErrorMessage('Error logging in');case 22:case\"end\":return _context.stop();}},_callee,null,[[1,18]]);}));return function handleSubmit(_x){return _ref.apply(this,arguments);};}();// State to manage error messages\nvar _useState3=useState(''),_useState4=_slicedToArray(_useState3,2),errorMessage=_useState4[0],setErrorMessage=_useState4[1];return/*#__PURE__*/_jsxs(\"div\",{style:styles.container,children:[/*#__PURE__*/_jsx(\"h2\",{style:styles.heading,children:\"Account Login\"}),/*#__PURE__*/_jsx(\"br\",{}),errorMessage&&/*#__PURE__*/_jsx(\"p\",{children:errorMessage}),/*#__PURE__*/_jsxs(\"form\",{onSubmit:handleSubmit,style:styles.form,children:[/*#__PURE__*/_jsx(\"input\",{type:\"text\",name:\"username\",placeholder:\"Username\",onChange:handleChange,style:styles.input}),/*#__PURE__*/_jsx(\"input\",{type:\"password\",name:\"password\",placeholder:\"Password\",onChange:handleChange,style:styles.input}),/*#__PURE__*/_jsx(\"button\",{type:\"submit\",style:styles.button,children:\"Login\"}),/*#__PURE__*/_jsx(Link,{to:\"/register\",children:\"Don't have an account? Register\"})]})]});}export default Login;","map":{"version":3,"names":["React","useState","useNavigate","jwt_decode","Link","jsx","_jsx","jsxs","_jsxs","styles","container","display","flexDirection","alignItems","justifyContent","height","heading","fontSize","errorMessage","color","marginTop","form","gap","width","padding","backgroundColor","borderRadius","boxShadow","input","border","button","cursor","buttonContainer","Login","_useState","username","password","_useState2","_slicedToArray","formData","setFormData","navigate","handleChange","event","_event$target","target","name","value","prevState","_objectSpread","_defineProperty","handleSubmit","_ref","_asyncToGenerator","_regeneratorRuntime","mark","_callee","response","data","decodedToken","_data","wrap","_callee$","_context","prev","next","preventDefault","fetch","method","headers","body","JSON","stringify","sent","ok","json","token","localStorage","setItem","role","setErrorMessage","message","t0","console","error","stop","_x","apply","arguments","_useState3","_useState4","style","children","onSubmit","type","placeholder","onChange","to"],"sources":["C:/Users/Matthew Liebenberg/Dropbox/ML20070003344/3- Full Stack Web Development/L3T15/Capstone Final/frontend/src/components/Login.js"],"sourcesContent":["import React, { useState } from 'react';\r\nimport { useNavigate } from 'react-router-dom';\r\nimport jwt_decode from 'jwt-decode';\r\nimport { Link } from 'react-router-dom';\r\n\r\nconst styles = {\r\n    container: {\r\n        display: 'flex',\r\n        flexDirection: 'column',\r\n        alignItems: 'center',\r\n        justifyContent: 'center',\r\n        height: '100vh'\r\n    },\r\n    heading: {\r\n        fontSize: '24px'\r\n    },\r\n    errorMessage: {\r\n        color: 'red',\r\n        fontSize: '14px',\r\n        marginTop: '10px'\r\n    },\r\n    form: {\r\n        display: 'flex',\r\n        flexDirection: 'column',\r\n        alignItems: 'center',\r\n        gap: '10px',\r\n        width: '500px',\r\n        padding: '20px',\r\n        backgroundColor: '#f7f7f7',\r\n        borderRadius: '8px',\r\n        boxShadow: '0px 0px 10px rgba(0, 0, 0, 0.1)'\r\n    },\r\n    input: {\r\n        width: '100%',\r\n        padding: '10px',\r\n        border: '1px solid #ccc',\r\n        borderRadius: '4px',\r\n        fontSize: '16px'\r\n    },\r\n    button: {\r\n        width: '100%',\r\n        padding: '10px',\r\n        backgroundColor: '#007bff',\r\n        color: 'white',\r\n        border: 'none',\r\n        borderRadius: '4px',\r\n        fontSize: '16px',\r\n        cursor: 'pointer'\r\n    },\r\n\r\n    buttonContainer: {\r\n        display: 'flex',\r\n        justifyContent: 'space-between',\r\n        width:  '50%',\r\n        gap: '10px'\r\n    }\r\n\r\n};\r\n\r\nfunction Login() {\r\n    // State to manage form data and error messages\r\n    const [formData, setFormData] = useState({\r\n        username: '',\r\n        password: '',\r\n        errorMessage: ''\r\n    });\r\n\r\n    // UseNavigate hook for navigation\r\n    const navigate = useNavigate();\r\n\r\n    // Event handler for input changes\r\n    const handleChange = (event) => {\r\n        const { name, value } = event.target;\r\n        setFormData(prevState => ({ ...prevState, [name]: value }));\r\n    }\r\n\r\n    // Event handler for form submission\r\n    const handleSubmit = async (event) => {\r\n        event.preventDefault();\r\n    \r\n        try {\r\n            // Send a POST request to the login endpoint\r\n            const response = await fetch('http://localhost:5000/users/login', {\r\n                method: 'POST',\r\n                headers: {\r\n                    'Content-Type': 'application/json'\r\n                },\r\n                body: JSON.stringify(formData)\r\n            });\r\n    \r\n            if (response.ok) {\r\n                const data = await response.json();\r\n    \r\n                if (data.token) {\r\n                    // Save the token in local storage\r\n                    localStorage.setItem('token', data.token);  // Save the token\r\n\r\n                    // Decode the token to get user role and save it in local storage\r\n                    const decodedToken = jwt_decode(data.token);\r\n                    if (decodedToken && decodedToken.role) {\r\n                        localStorage.setItem('userRole', decodedToken.role);\r\n                    }\r\n                    \r\n                    // Store the username in localStorage during login\r\n                    localStorage.setItem('username', formData.username);\r\n    \r\n                    // Navigate to the home page\r\n                    navigate('/'); \r\n                } else {\r\n                    // Display an error message for invalid credentials\r\n                    setErrorMessage('Invalid credentials');\r\n                }\r\n            } else {\r\n                const data = await response.json();\r\n                // Display an error message received from the server\r\n                setErrorMessage(data.message || 'Error logging in');\r\n            }\r\n        } catch (error) {\r\n            console.error(\"Error during login:\", error);\r\n            // Display error message\r\n            setErrorMessage('Error logging in');\r\n        }\r\n    }\r\n    \r\n    \r\n     // State to manage error messages\r\n    const [errorMessage, setErrorMessage] = useState('');\r\n\r\n    return (\r\n        <div style={styles.container}>\r\n        <h2 style={styles.heading}>Account Login</h2>\r\n        <br></br>\r\n        {/* Display error message if present */}\r\n        {errorMessage && <p>{errorMessage}</p>}\r\n        {/* Login form */}\r\n        <form onSubmit={handleSubmit} style={styles.form}>\r\n            <input\r\n                type=\"text\"\r\n                name=\"username\"\r\n                placeholder=\"Username\"\r\n                onChange={handleChange}\r\n                style={styles.input}\r\n            />\r\n            <input\r\n                type=\"password\"\r\n                name=\"password\"\r\n                placeholder=\"Password\"\r\n                onChange={handleChange}\r\n                style={styles.input}\r\n            />\r\n            <button type=\"submit\" style={styles.button}>Login</button>\r\n            <Link to=\"/register\">Don't have an account? Register</Link>\r\n        </form>\r\n    </div>\r\n    );\r\n}\r\n\r\nexport default Login;\r\n"],"mappings":"g+BAAA,MAAO,CAAAA,KAAK,EAAIC,QAAQ,KAAQ,OAAO,CACvC,OAASC,WAAW,KAAQ,kBAAkB,CAC9C,MAAO,CAAAC,UAAU,KAAM,YAAY,CACnC,OAASC,IAAI,KAAQ,kBAAkB,CAAC,OAAAC,GAAA,IAAAC,IAAA,gCAAAC,IAAA,IAAAC,KAAA,yBAExC,GAAM,CAAAC,MAAM,CAAG,CACXC,SAAS,CAAE,CACPC,OAAO,CAAE,MAAM,CACfC,aAAa,CAAE,QAAQ,CACvBC,UAAU,CAAE,QAAQ,CACpBC,cAAc,CAAE,QAAQ,CACxBC,MAAM,CAAE,OACZ,CAAC,CACDC,OAAO,CAAE,CACLC,QAAQ,CAAE,MACd,CAAC,CACDC,YAAY,CAAE,CACVC,KAAK,CAAE,KAAK,CACZF,QAAQ,CAAE,MAAM,CAChBG,SAAS,CAAE,MACf,CAAC,CACDC,IAAI,CAAE,CACFV,OAAO,CAAE,MAAM,CACfC,aAAa,CAAE,QAAQ,CACvBC,UAAU,CAAE,QAAQ,CACpBS,GAAG,CAAE,MAAM,CACXC,KAAK,CAAE,OAAO,CACdC,OAAO,CAAE,MAAM,CACfC,eAAe,CAAE,SAAS,CAC1BC,YAAY,CAAE,KAAK,CACnBC,SAAS,CAAE,iCACf,CAAC,CACDC,KAAK,CAAE,CACHL,KAAK,CAAE,MAAM,CACbC,OAAO,CAAE,MAAM,CACfK,MAAM,CAAE,gBAAgB,CACxBH,YAAY,CAAE,KAAK,CACnBT,QAAQ,CAAE,MACd,CAAC,CACDa,MAAM,CAAE,CACJP,KAAK,CAAE,MAAM,CACbC,OAAO,CAAE,MAAM,CACfC,eAAe,CAAE,SAAS,CAC1BN,KAAK,CAAE,OAAO,CACdU,MAAM,CAAE,MAAM,CACdH,YAAY,CAAE,KAAK,CACnBT,QAAQ,CAAE,MAAM,CAChBc,MAAM,CAAE,SACZ,CAAC,CAEDC,eAAe,CAAE,CACbrB,OAAO,CAAE,MAAM,CACfG,cAAc,CAAE,eAAe,CAC/BS,KAAK,CAAG,KAAK,CACbD,GAAG,CAAE,MACT,CAEJ,CAAC,CAED,QAAS,CAAAW,KAAKA,CAAA,CAAG,CACb;AACA,IAAAC,SAAA,CAAgCjC,QAAQ,CAAC,CACrCkC,QAAQ,CAAE,EAAE,CACZC,QAAQ,CAAE,EAAE,CACZlB,YAAY,CAAE,EAClB,CAAC,CAAC,CAAAmB,UAAA,CAAAC,cAAA,CAAAJ,SAAA,IAJKK,QAAQ,CAAAF,UAAA,IAAEG,WAAW,CAAAH,UAAA,IAM5B;AACA,GAAM,CAAAI,QAAQ,CAAGvC,WAAW,CAAC,CAAC,CAE9B;AACA,GAAM,CAAAwC,YAAY,CAAG,QAAf,CAAAA,YAAYA,CAAIC,KAAK,CAAK,CAC5B,IAAAC,aAAA,CAAwBD,KAAK,CAACE,MAAM,CAA5BC,IAAI,CAAAF,aAAA,CAAJE,IAAI,CAAEC,KAAK,CAAAH,aAAA,CAALG,KAAK,CACnBP,WAAW,CAAC,SAAAQ,SAAS,SAAAC,aAAA,CAAAA,aAAA,IAAUD,SAAS,KAAAE,eAAA,IAAGJ,IAAI,CAAGC,KAAK,IAAG,CAAC,CAC/D,CAAC,CAED;AACA,GAAM,CAAAI,YAAY,6BAAAC,IAAA,CAAAC,iBAAA,cAAAC,mBAAA,GAAAC,IAAA,CAAG,SAAAC,QAAOb,KAAK,MAAAc,QAAA,CAAAC,IAAA,CAAAC,YAAA,CAAAC,KAAA,QAAAN,mBAAA,GAAAO,IAAA,UAAAC,SAAAC,QAAA,iBAAAA,QAAA,CAAAC,IAAA,CAAAD,QAAA,CAAAE,IAAA,SAC7BtB,KAAK,CAACuB,cAAc,CAAC,CAAC,CAACH,QAAA,CAAAC,IAAA,GAAAD,QAAA,CAAAE,IAAA,SAII,CAAAE,KAAK,CAAC,mCAAmC,CAAE,CAC9DC,MAAM,CAAE,MAAM,CACdC,OAAO,CAAE,CACL,cAAc,CAAE,kBACpB,CAAC,CACDC,IAAI,CAAEC,IAAI,CAACC,SAAS,CAACjC,QAAQ,CACjC,CAAC,CAAC,QANIkB,QAAQ,CAAAM,QAAA,CAAAU,IAAA,KAQVhB,QAAQ,CAACiB,EAAE,EAAAX,QAAA,CAAAE,IAAA,WAAAF,QAAA,CAAAE,IAAA,SACQ,CAAAR,QAAQ,CAACkB,IAAI,CAAC,CAAC,QAA5BjB,IAAI,CAAAK,QAAA,CAAAU,IAAA,CAEV,GAAIf,IAAI,CAACkB,KAAK,CAAE,CACZ;AACAC,YAAY,CAACC,OAAO,CAAC,OAAO,CAAEpB,IAAI,CAACkB,KAAK,CAAC,CAAG;AAE5C;AACMjB,YAAY,CAAGxD,UAAU,CAACuD,IAAI,CAACkB,KAAK,CAAC,CAC3C,GAAIjB,YAAY,EAAIA,YAAY,CAACoB,IAAI,CAAE,CACnCF,YAAY,CAACC,OAAO,CAAC,UAAU,CAAEnB,YAAY,CAACoB,IAAI,CAAC,CACvD,CAEA;AACAF,YAAY,CAACC,OAAO,CAAC,UAAU,CAAEvC,QAAQ,CAACJ,QAAQ,CAAC,CAEnD;AACAM,QAAQ,CAAC,GAAG,CAAC,CACjB,CAAC,IAAM,CACH;AACAuC,eAAe,CAAC,qBAAqB,CAAC,CAC1C,CAACjB,QAAA,CAAAE,IAAA,kBAAAF,QAAA,CAAAE,IAAA,UAEkB,CAAAR,QAAQ,CAACkB,IAAI,CAAC,CAAC,SAA5BjB,KAAI,CAAAK,QAAA,CAAAU,IAAA,CACV;AACAO,eAAe,CAACtB,KAAI,CAACuB,OAAO,EAAI,kBAAkB,CAAC,CAAC,QAAAlB,QAAA,CAAAE,IAAA,kBAAAF,QAAA,CAAAC,IAAA,IAAAD,QAAA,CAAAmB,EAAA,CAAAnB,QAAA,aAGxDoB,OAAO,CAACC,KAAK,CAAC,qBAAqB,CAAArB,QAAA,CAAAmB,EAAO,CAAC,CAC3C;AACAF,eAAe,CAAC,kBAAkB,CAAC,CAAC,yBAAAjB,QAAA,CAAAsB,IAAA,MAAA7B,OAAA,iBAE3C,kBA7CK,CAAAL,YAAYA,CAAAmC,EAAA,SAAAlC,IAAA,CAAAmC,KAAA,MAAAC,SAAA,OA6CjB,CAGA;AACD,IAAAC,UAAA,CAAwCxF,QAAQ,CAAC,EAAE,CAAC,CAAAyF,UAAA,CAAApD,cAAA,CAAAmD,UAAA,IAA7CvE,YAAY,CAAAwE,UAAA,IAAEV,eAAe,CAAAU,UAAA,IAEpC,mBACIlF,KAAA,QAAKmF,KAAK,CAAElF,MAAM,CAACC,SAAU,CAAAkF,QAAA,eAC7BtF,IAAA,OAAIqF,KAAK,CAAElF,MAAM,CAACO,OAAQ,CAAA4E,QAAA,CAAC,eAAa,CAAI,CAAC,cAC7CtF,IAAA,QAAQ,CAAC,CAERY,YAAY,eAAIZ,IAAA,MAAAsF,QAAA,CAAI1E,YAAY,CAAI,CAAC,cAEtCV,KAAA,SAAMqF,QAAQ,CAAE1C,YAAa,CAACwC,KAAK,CAAElF,MAAM,CAACY,IAAK,CAAAuE,QAAA,eAC7CtF,IAAA,UACIwF,IAAI,CAAC,MAAM,CACXhD,IAAI,CAAC,UAAU,CACfiD,WAAW,CAAC,UAAU,CACtBC,QAAQ,CAAEtD,YAAa,CACvBiD,KAAK,CAAElF,MAAM,CAACmB,KAAM,CACvB,CAAC,cACFtB,IAAA,UACIwF,IAAI,CAAC,UAAU,CACfhD,IAAI,CAAC,UAAU,CACfiD,WAAW,CAAC,UAAU,CACtBC,QAAQ,CAAEtD,YAAa,CACvBiD,KAAK,CAAElF,MAAM,CAACmB,KAAM,CACvB,CAAC,cACFtB,IAAA,WAAQwF,IAAI,CAAC,QAAQ,CAACH,KAAK,CAAElF,MAAM,CAACqB,MAAO,CAAA8D,QAAA,CAAC,OAAK,CAAQ,CAAC,cAC1DtF,IAAA,CAACF,IAAI,EAAC6F,EAAE,CAAC,WAAW,CAAAL,QAAA,CAAC,iCAA+B,CAAM,CAAC,EACzD,CAAC,EACN,CAAC,CAEV,CAEA,cAAe,CAAA3D,KAAK"},"metadata":{},"sourceType":"module","externalDependencies":[]}